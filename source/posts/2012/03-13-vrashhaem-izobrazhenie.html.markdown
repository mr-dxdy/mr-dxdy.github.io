---
title: "Вращаем изображение"
date: '2012-03-13 22:23:28 +0400'
tags:
- Новости
- Алгоритмы
---

Нашел у себя еще один проект на тему "Обработка изображений". В принципе ничего нового, идея такая же как и при масштабировании изображения нам нужно найти прообраз функции. Но не будем забегать вперед и сначала огласим полностью задачу "Вращение объекта":

* Загрузка цветного изображения.
* Выделение прямоугольного региона.
* Определяем произвольную точку поворота, ограничимся условием выбора точки внутри прямоугольника.
* Задать угол поворота.
READMORE
Реализация: С++ с использованием библиотеки Qt 4.7

Теперь продолжим разъяснение алгоритма. Пробегаем весь выделенный прямоугольный регион и для каждого пикселя `(x,y)` вычисляем координаты в новом "перевернутом" изображении по правилу (`(pointX,pointY)` - точка вращения):

```c
double iX = pointX + (x-pointX)*cos(angle) - (y-pointY)*sin(angle),
      iY = pointY + (x-pointX)*sin(angle) + (y-pointY)*cos(angle);
```

Теперь мы нашли координату в перевернутом изображении. Остается узнать ее цвет из исходного изображения, ведь мы работаем c вещественными координатами, то точно определить цвет мы не сможем, поэтому надо использовать интерполяцию, я использовал бикубическую, хотя для данного случая хватит и биквадратической. Прообраз функции будет такой:

```c
double oy = pointY - (iX-pointX)*sin(angle) + (iY-pointY)*cos(angle),
       ox = pointX + (iX-pointX)*cos(angle) + (iY-pointY)*sin(angle);
```

Для наглядности привожу скриншот программы:

![Вращение изображения](/posts/2012/03-13-vrashhaem-izobrazhenie/rotate.jpeg)
